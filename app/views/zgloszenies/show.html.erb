<%= render 'zgloszenies/edit/page', zgloszenies: @zgloszenies %>

<div class="container">
    <div class="row">
    <div class="col-md-4">
            <div class="well well-sm">
                <div class="media">
                    <div class="media-body">
                        <h4 class="media-heading"></h4>
                        <center><p>
                            <%= image_tag(generate_qr(@zgloszeny.id.to_s), class: "qr-code") %></p></center><br/>
                            <h4><p><strong>Dział: </strong> <%= Dzial.where(id:@zgloszeny.dzial_id).pluck(:nazwa).last %></p></h4>
                            <h4><p><strong>Priorytet: </strong><%= @zgloszeny.priorytet %></p></h4>
  <h4><p><strong>Status:</strong> <%= t("activerecord.attributes.zgloszenie.statuses.#{@zgloszeny.status}") %></p></h4>
  <h4><p><strong>Data zgłoszenia:</strong> <%= @zgloszeny.data_zgloszenia %></p></h4>
  <h4><p><strong>Data naprawy:</strong> <%= @zgloszeny.data_naprawy %></p></h4>
  <h4><p><strong>Nazwa urzadzenia:</strong> <%= @zgloszeny.nazwa_urzadzenia %></p></h4>
  <h4><p><strong>Opis uszkodzenia:</strong> <%= @zgloszeny.opis_uszkodzenia %></p></h4>
  <h4><p><strong>Wysyłka:</strong> <%= @zgloszeny.wysylka %></p></h4>
                        </p>
                    </div>
                </div>
            </div>
        </div>
  </div>
</div>

<div class="jumbotron" align="center">
  <%= link_to 'Edytuj Zgłoszenie', edit_zgloszeny_path(@zgloszeny), class:'btn btn btn-danger' %>
  <%= link_to 'Dodaj Zgłoszenie', new_zgloszeny_path, class:'btn btn-warning' %>
  <%= link_to 'Lista Zgłoszeń', zgloszenies_path, class:'btn btn btn-primary' %>
  <%= link_to 'Wydrukuj zgłoszenie', print_zgloszeny_path(@zgloszeny.id), :class => "btn btn btn-success", :method => :get %>
  <%= link_to 'Pobierz PDF', zgloszeny_path(@zgloszenie, format: "pdf"), class:'btn btn-primary'%>
</div>

<div class="jumbotron">
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Autor</th>
          <th>Data</th>
          <th>Treść wiadomości </th>
        </tr>
      </thead>
      <tbody>
        <% ZgloszenieAktywnosc.all.each do |zgloszenie_aktywnosc| %>
         <% if @zgloszeny == zgloszenie_aktywnosc.zgloszenie %>
          <tr>
            <td><%= User.where(id:zgloszenie_aktywnosc.user_id).pluck(:first_name).last %>
            <%= User.where(id:zgloszenie_aktywnosc.user_id).pluck(:last_name).last %></td>
            <td><%= zgloszenie_aktywnosc.created_at.strftime("%H:%M, %d.%m.%Y") %></td>
            <td><%= zgloszenie_aktywnosc.tresc %></td>
          </tr>
         <% end %>  <% end %>
      </tbody>
    </table>
  </div>
</div>

<div class="jumbotron">
  <%= form_for ZgloszenieAktywnosc.new do |f| %>
    <%= f.hidden_field :zgloszenie_id, :value => @zgloszeny.id  %>
    <%= f.hidden_field :user_id, :value => current_user.id  %>
    <p>Treść notatki: <%= f.text_area :tresc, class:"form-control" %> </p>
    <%= f.submit "Dodaj Notatke", class:'btn btn btn-primary' %>
  <% end %>
</div>
